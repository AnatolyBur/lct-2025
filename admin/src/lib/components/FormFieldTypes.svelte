<!-- –ü–∞–ª–∏—Ç—Ä–∞ —Ç–∏–ø–æ–≤ –ø–æ–ª–µ–π –¥–ª—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ —Ñ–æ—Ä–º -->
<script lang="ts">
  import { createEventDispatcher } from 'svelte';

  const dispatch = createEventDispatcher();

  // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø–æ–ª–µ–π
  const fieldTypes = [
    {
      type: 'text',
      label: '–¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ',
      icon: 'üìù',
      description: '–û–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç'
    },
    {
      type: 'email',
      label: 'Email',
      icon: 'üìß',
      description: '–ê–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã'
    },
    {
      type: 'textarea',
      label: '–ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç',
      icon: 'üìÑ',
      description: '–¢–µ–∫—Å—Ç –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫'
    },
    {
      type: 'select',
      label: '–í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫',
      icon: 'üìã',
      description: '–í—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤'
    },
    {
      type: 'radio',
      label: '–†–∞–¥–∏–æ–∫–Ω–æ–ø–∫–∏',
      icon: 'üîò',
      description: '–í—ã–±–æ—Ä –æ–¥–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞'
    },
    {
      type: 'checkbox',
      label: '–ß–µ–∫–±–æ–∫—Å',
      icon: '‚òëÔ∏è',
      description: '–î–∞/–ù–µ—Ç –∏–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä'
    },
    {
      type: 'file',
      label: '–§–∞–π–ª',
      icon: 'üìé',
      description: '–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞'
    },
    {
      type: 'date',
      label: '–î–∞—Ç–∞',
      icon: 'üìÖ',
      description: '–í—ã–±–æ—Ä –¥–∞—Ç—ã'
    },
    {
      type: 'number',
      label: '–ß–∏—Å–ª–æ',
      icon: 'üî¢',
      description: '–ß–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ'
    },
    {
      type: 'tel',
      label: '–¢–µ–ª–µ—Ñ–æ–Ω',
      icon: 'üìû',
      description: '–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞'
    },
    {
      type: 'url',
      label: 'URL',
      icon: 'üîó',
      description: '–í–µ–±-–∞–¥—Ä–µ—Å'
    }
  ];

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è
  function handleAddField(fieldType: string) {
    dispatch('addField', { fieldType });
  }

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
  function handleDragStart(event: DragEvent, fieldType: string) {
    if (event.dataTransfer) {
      event.dataTransfer.setData('text/plain', fieldType);
      event.dataTransfer.effectAllowed = 'copy';
    }
  }
</script>

<div class="field-types">
  <div class="field-types-header">
    <h4>–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ</h4>
    <p class="field-types-description">
      –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–æ–ª—è –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –µ–≥–æ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
    </p>
  </div>

  <div class="field-types-grid">
    {#each fieldTypes as fieldType}
      <div 
        class="field-type-item"
        draggable="true"
        on:dragstart={(e) => handleDragStart(e, fieldType.type)}
        on:click={() => handleAddField(fieldType.type)}
        role="button"
        tabindex="0"
        on:keydown={(e) => e.key === 'Enter' && handleAddField(fieldType.type)}
      >
        <div class="field-type-icon">
          {fieldType.icon}
        </div>
        <div class="field-type-content">
          <div class="field-type-label">
            {fieldType.label}
          </div>
          <div class="field-type-description">
            {fieldType.description}
          </div>
        </div>
      </div>
    {/each}
  </div>

  <div class="field-types-footer">
    <p class="field-types-hint">
      üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –ø–æ–ª–µ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
    </p>
  </div>
</div>

<style>
  .field-types {
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .field-types-header {
    margin-bottom: 1rem;
  }

  .field-types-header h4 {
    margin: 0 0 0.5rem 0;
    font-size: 1rem;
    font-weight: 600;
    color: #374151;
  }

  .field-types-description {
    margin: 0;
    font-size: 0.875rem;
    color: #6b7280;
    line-height: 1.4;
  }

  .field-types-grid {
    flex: 1;
    display: grid;
    grid-template-columns: 1fr;
    gap: 0.5rem;
    overflow-y: auto;
    max-height: 500px;
  }

  .field-type-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    border: 1px solid #e5e7eb;
    border-radius: 0.375rem;
    background: white;
    cursor: pointer;
    transition: all 0.15s ease-in-out;
    user-select: none;
  }

  .field-type-item:hover {
    border-color: #3b82f6;
    background: #f8fafc;
    transform: translateY(-1px);
    box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.1);
  }

  .field-type-item:focus {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
  }

  .field-type-item:active {
    transform: translateY(0);
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.1);
  }

  .field-type-icon {
    font-size: 1.5rem;
    flex-shrink: 0;
  }

  .field-type-content {
    flex: 1;
    min-width: 0;
  }

  .field-type-label {
    font-size: 0.875rem;
    font-weight: 500;
    color: #374151;
    margin-bottom: 0.25rem;
  }

  .field-type-description {
    font-size: 0.75rem;
    color: #6b7280;
    line-height: 1.3;
  }

  .field-types-footer {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid #e5e7eb;
  }

  .field-types-hint {
    margin: 0;
    font-size: 0.75rem;
    color: #6b7280;
    line-height: 1.4;
    text-align: center;
  }

  /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è */
  .field-type-item[draggable="true"] {
    cursor: grab;
  }

  .field-type-item[draggable="true"]:active {
    cursor: grabbing;
  }


  /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
  @media (max-width: 768px) {
    .field-types-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .field-type-item {
      flex-direction: column;
      text-align: center;
      gap: 0.5rem;
    }
    
    .field-type-content {
      text-align: center;
    }
  }
</style>
